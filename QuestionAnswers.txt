1:
See program.

2:
Possibility 1: "tcp"
Possibility 2: "ip and tcp"

3:
See program.
